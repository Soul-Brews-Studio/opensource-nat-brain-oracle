# Timestamp Hook System - Complete Implementation

**Time**: 09:33 GMT+7

## What We Learned

- **Hook stdout visibility**: Only `SessionStart` + `UserPromptSubmit` inject to agent context
- **Subagents isolated**: Task tool spawns separate context ‚Äî no hook inheritance
- **Smart optimization**: Move automated rules to learnings, keep CLAUDE.md lean
- **Plugin marketplace**: Use existing marketplace, don't duplicate

## How Things Connect

- **UserPromptSubmit hook** ‚Üí Main agent gets timestamp automatically
- **Agent definitions** ‚Üí Subagents enforce START+END timestamps themselves
- **Hook + Definition** = Complete coverage without manual `date` calls
- **Project settings** ‚Üí Enable plugins per-project, override user settings

## Key Discoveries

1. **Format**: `üïê 09:33:45 (1765593225)` ‚Äî Human readable + Unix for duration calc
2. **Plugin format**: `name@marketplace` ‚Äî ‡∏ï‡πâ‡∏≠‡∏á match ‡∏ä‡∏∑‡πà‡∏≠ marketplace ‡∏ó‡∏µ‡πà installed
3. **Context efficiency**: ‡∏•‡∏ö 22 lines ‡∏à‡∏≤‡∏Å CLAUDE.md ‚Üí save ~400 tokens/session
4. **Learning provenance**: Document HOW you learned (user, docs, experiment)

## Commits (Session)

- `d782c59` fix: enable voice-notify plugin correctly
- `84cdfd3` refactor: remove redundant Timestamp Rule (-22 lines)
- `7d1036e` docs: clarify main agent doesn't need date
- `8021dda` feat: seconds + unix timestamp format
- `de77879` feat: START+END timestamps to all subagents
- `83eb881` feat: UserPromptSubmit hook for timestamp
- `0f6a526` feat: /wip command

## Tags

`hooks` `timestamp` `plugins` `smart-optimization` `subagents`

## Raw Thoughts

- Pattern: Learn ‚Üí Add to CLAUDE.md ‚Üí Automate ‚Üí Optimize (move to learnings)
- ‡∏ñ‡πâ‡∏≤ auto ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ã‡πâ‡∏≥‡πÉ‡∏ô CLAUDE.md
- Subagent START+END = main agent ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì duration ‡πÑ‡∏î‡πâ
- Plugin troubleshooting: check `~/.claude/plugins/known_marketplaces.json`
