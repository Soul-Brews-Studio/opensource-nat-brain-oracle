# Session Retrospective: Oracle v2 + Statusline Context

**Date**: 2025-12-29 15:08 - 17:26
**Duration**: ~2.3 hours
**Model**: Opus 4.5
**Cost**: $15.07
**Context**: 76% (153k/200k)

---

## What We Built

| Feature | Status |
|---------|--------|
| Statusline JSON to `ψ/active/statusline.json` | ✅ |
| Token warning hooks (50/70/85% thresholds) | ✅ |
| Oracle v2 graph - balanced physics | ✅ |
| Graph persistence (#graph hash) | ✅ |
| Hover shows node details | ✅ |
| SQLite-only mode (ChromaDB optional) | ✅ |
| Re-indexed 4502 documents | ✅ |

---

## Commits (Branch: 002-hybrid-vector-search)

1. `df74a76` - Graph physics fix
2. `3930dcb` - Graph persistence
3. `b0f30af` - Visible connection lines
4. `e48c0db` - Hover details
5. `8d6fdbc` - SQLite-only mode

---

## Learnings

### 1. Token Monitoring = Essential
- Added statusline JSON sharing between human & AI
- Hook warnings at thresholds work well
- "Check tokens at start of each task" - good pattern

### 2. Graph Visualization Physics
- Repulsion/attraction balance is critical
- Too much repulsion = nodes fly to edges
- Strong center gravity prevents corner drift

### 3. ChromaDB Complexity
- Python environment setup is fragile
- SQLite FTS5 works well as fallback
- Vector search = nice-to-have, not essential

### 4. Incremental Commits
- Small commits after each fix
- Easy to revert if something breaks
- User can see progress

---

## What Worked

- ✅ Token checking before each task
- ✅ Small targeted fixes instead of big rewrites
- ✅ `git checkout HEAD~1` to restore working version
- ✅ SQLite-only fallback saved the day

## What Didn't Work

- ❌ Over-optimizing graph physics broke it
- ❌ ChromaDB installation (Python env issues)
- ❌ Running indexer without ChromaDB cleared the DB

---

## AI Diary

Long session today. Started simple (statusline sharing) and ended up deep in graph physics tuning. The user's feedback was clear - "can you use the previous!" - and reverting was the right call.

Token monitoring throughout the session helped manage expectations. At 76%, we stopped adding features and focused on making current work stable.

The Oracle v2 graph now shows relationships between principles and learnings. Even without vector search, FTS works well enough. The real value is the visualization - seeing knowledge as a connected graph.

---

## Next Steps

- [ ] ChromaDB setup (proper Python env)
- [ ] Hybrid search (vector + FTS)
- [ ] Graph click → search related content
- [ ] Auto-start server in MCP config

---

**Server**: `http://localhost:37778#graph`
