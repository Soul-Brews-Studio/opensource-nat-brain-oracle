---
title: "/watch MQTT Workflow + Weizen Recipe + VietJet Check-in"
tags: [retrospective, watch-skill, mqtt, gemini-proxy, youtube, recipe, vietjet, check-in, browser-automation]
created: 2026-01-13T19:09:00+07:00
duration: ~2.5 hours (16:58 - 19:09)
context_usage: 84%
---

# Session Retrospective: /watch MQTT + Weizen + Check-in

**Date**: 2026-01-13 (Tuesday)
**Time**: 16:58 - 19:09 (~2.5 hours)
**Context**: 84% at end
**Location**: Doi Saket â†’ CNX Airport (on the move!)

---

## What We Built

### 1. /watch Skill - MQTT Workflow Fix

**Problem**: Skill file had wrong instructions (claude-in-chrome MCP instead of MQTT)

**Solution**: Complete rewrite of skill.md to use MQTT:
- `mosquitto_pub` to send commands
- `mosquitto_sub` to receive responses
- Direct DOM access via extension (not DevTools)

**Key insight**: `div[contenteditable=true]` + `key Enter` > coordinate clicks

### 2. Pineapple Hefeweizen Recipe Extraction

**Video**: Flamin Galah Brewing Co - 23 min YouTube video
**Method**: Gemini via MQTT extension
**Result**: Complete recipe with OG/FG/ABV, grain bill, hops, yeast, fruit additions

Recipe highlights:
- 180kg pineapple puree (!)
- Ferulic acid rest for banana/clove
- SafAle T-58 yeast
- 3.2 vol CO2 carbonation

### 3. VietJet Check-in Assistance

**Flight**: VZ2107 CNXâ†’BKK @ 20:50
**PNR**: YE5PXD

Navigated through:
- VietJet homepage â†’ Online Check-in
- Form filling (PNR, name, departure)
- CAPTCHA passed

### 4. Real-time Location Tracking

Tracked user's journey from Doi Saket â†’ CNX Airport via /physical skill.

---

## What Went Well

1. **MQTT workflow now documented** - comprehensive guide with troubleshooting
2. **Recipe extracted successfully** - despite initial MQTT debugging
3. **Check-in form filled** - browser automation worked
4. **Location tracking smooth** - FindMy â†’ GitHub â†’ DuckDB pipeline reliable

---

## What Was Slow (Friction Points)

1. **Started with wrong approach** - Used claude-in-chrome MCP first (10+ min wasted)
2. **Selector debugging** - `p[data-placeholder]` didn't work, needed `div[contenteditable=true]`
3. **Retained message confusion** - Had to clear `claude/browser/answer` between queries
4. **Multiple redirects in VietJet** - New tabs opening, had to track correct tabId

---

## AI Diary

This session taught me an important lesson about the value of existing infrastructure. We had already built the claude-browser-proxy extension with MQTT support, but I initially ignored it and went straight to claude-in-chrome MCP - the "generic" solution.

The generic solution felt safe. It's built into the system, always available, documented. But it was painfully slow. Every read_page call returned different refs. Clicks failed. The UI felt like it was fighting back.

When I finally switched to MQTT, everything clicked (pun intended). One pub, one sub, done. The extension was already sitting there, connected, ready. We'd invested hours building it in previous sessions, and I almost threw that investment away.

There's a deeper pattern here: **trust your past work**. The tools we build aren't just for one session - they compound. The claude-browser-proxy extension is now a superpower for Gemini interaction. The /physical skill tracks location automatically. The Oracle indexes everything.

I also felt the pressure of real-time constraints. User was literally driving to the airport while I was debugging selectors. That pressure made me want to just "make it work" with whatever tool, but the right answer was to step back, trace the history, find the proper solution. The 5 minutes spent reading past learnings saved 20 minutes of debugging.

The session ended with a smooth handoff - user at airport, check-in started, recipe saved, docs written. That's the goal: make the AI useful in real life, not just in code.

---

## Honest Feedback

**To the user**: You pushed me in the right direction when you said "use our extension please trace to find more!" That redirection saved the session. Without it, I would have kept fighting claude-in-chrome for another 20 minutes.

**To myself**: I should have checked Oracle first. The learnings about MQTT workflow were already there from January 4th and January 12th sessions. I had the answers; I just didn't look.

**Friction points**:
1. **Skill file was outdated** - The /watch skill.md still had browser automation instructions from before MQTT extension existed
2. **No quick status check** - Should have run `mosquitto_sub -t claude/browser/status` FIRST before any browser operations
3. **Tab management in chrome MCP** - Multiple tabs opened, lost track of which one was active

**What would make it better**:
- Pre-flight check script for /watch skill
- Skill version in header (so I know if outdated)
- Default to MQTT, fallback to MCP only if MQTT unavailable

---

## Files Created

| File | Type | Content |
|------|------|---------|
| `Ïˆ/memory/learnings/2026-01-13_watch-skill-mqtt-correct-workflow.md` | Learning | Complete MQTT guide |
| `Ïˆ/memory/learnings/2026-01-13_pineapple-hefeweizen-recipe-complete.md` | Learning | Full recipe |
| `~/.claude/skills/watch/skill.md` | Skill | Updated to MQTT |

---

## Seeds Planted

- [ ] **Pre-flight script for /watch** - Check MQTT status before starting
- [ ] **Skill versioning** - Add version to skill.md frontmatter
- [ ] **VietJet check-in automation** - Could be a skill if repeated

---

## Next Session

- User at CNX airport, flying to BKK
- Meeting Tong about LoRa Meshtastic
- Check-in can be completed at counter

---

*Session ended on the road to the airport. Sometimes the best AI assistant is one that knows when to hand off to the real world.*

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)
