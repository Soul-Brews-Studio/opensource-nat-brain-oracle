# Meshtastic FIREMAN hwModel Flash Session

**Time**: 16:34 (Tuesday 13 January 2026)
**Duration**: ~1.5 hours
**Context Used**: 100%

## What We Did

### 1. Deep Trace Meshtastic
- `/trace meshtastic lora firmware --deep` with 5 parallel subagents
- Found extensive documentation from Jan 12 sessions
- Oracle has full reference now

### 2. Flashed 3 Devices
| Device | MAC | Hardware |
|--------|-----|----------|
| Laris-4 | 48:27:e2:8a:5b:ec | PRIVATE_HW |
| FIREMAN-1 | 48:27:e2:8a:5c:4c | 200 (FIREMAN) |
| FIREMAN-5 | 48:27:e2:8a:5c:88 | 200 (FIREMAN) |

### 3. Created Custom Hardware Model
- Added `FIREMAN = 200` to mesh.proto
- Modified mesh.pb.h, architecture.h, variant.h
- Now shows `hwModel: 200` instead of PRIVATE_HW

### 4. Position Loggers
- `position-logger.py` - USB serial logging to CSV
- `position-logger-ble.py` - BLE logging from Mac
- pm2 service on white.local

### 5. BLE Discovery
```
F1_5c4c - FIREMAN-1
F5_5c88 - FIREMAN-5
L2_5c54 - Laris-2
```

## AI Diary

This session was a masterclass in hardware firmware iteration. What started as a simple "trace meshtastic" turned into a full exploration of custom hardware models, position logging, and BLE connectivity.

I was genuinely surprised when we successfully added FIREMAN as a custom hwModel. The Meshtastic firmware structure is clean - the protobuf enum, generated headers, and architecture.h all fit together logically. The fact that we could add `FIREMAN = 200` and have it propagate through the build system showed good design.

The moment when BLE scan returned `F1_5c4c, F5_5c88, L2_5c54` was satisfying - all three devices visible, ready for wireless logging. This opens up mobile position tracking without USB tethering.

What challenged me was the protobuf parsing errors in meshtastic-cli. The Python library doesn't know about hwModel 200, so it throws DecodeError. But the core functionality still works - positions still log. This taught me that error messages aren't always fatal.

I feel accomplished - we went from "what's meshtastic?" to custom firmware, device fleet, and BLE logging in one session. The Oracle now has complete reference docs for future sessions.

## Honest Feedback

### What Went Well
- Parallel subagent search found comprehensive history
- Build/flash/configure workflow is now scripted
- BLE logger works on first try

### Friction Points
1. **Proto regeneration** - Had to manually edit mesh.pb.h because nanopb wasn't installed on white.local. Should document the full proto toolchain.

2. **Device naming confusion** - Started with Laris-4/5, ended with FIREMAN-1/5. The naming convention shifted mid-session. Need clearer naming strategy upfront.

3. **Context exhaustion** - Hit 100% before completing BLE tmux setup. The session was feature-rich but could have been split into 2 sessions.

### Suggestions
- Create a `flash-all.sh` script for batch flashing
- Add hwModel name mapping to position-logger.py
- Document the proto toolchain setup for custom hwModels

## Files Changed

### laris-meshtastic repo
- `position-logger.py` - USB serial logger
- `position-logger-ble.py` - BLE logger
- `README.md` - Device fleet + BLE docs
- `variants/custom_sx1280_board/variant.h` - FIREMAN hwModel
- `firmware/` - Modified proto and headers

### Nat-s-Agents repo
- `ψ/memory/learnings/2026-01-13_meshtastic-*.md` (4 files)
- `ψ/memory/learnings/2026-01-13_custom-hardware-model-fireman-hwmodel200.md`

## Links

- [laris-meshtastic](https://github.com/laris-co/laris-meshtastic)
- white.local: `~/laris-meshtastic-build/`
- Positions: `~/positions.csv`

---

**Next Session**: Run BLE logger, test mesh range, document MQTT integration
