# Session Retrospective: Oracle 3D Graph Polish

**Date**: 2026-01-11 20:12 (Sunday)
**Duration**: ~25 minutes (19:44 - 20:12)
**Focus**: Fixing Graph3D issues and adding file viewer

---

## What We Built

Continued from previous session's Graph3D work:

### Fixes
1. **Memory leak fix**: Proper Three.js cleanup on unmount
   - Dispose shared geometry, all materials, link geometries
   - Clear all refs, remove from scene

2. **Type filter**: Clickable legend to filter by node type
   - Shows count per type: `Principle (359) Learning (100)`
   - Hides types with 0 nodes (Retro hidden - intentionally excluded from API)

3. **File viewer**: Click filename to view full document content
   - Panel overlay with file content
   - Styled as link, not button (per user feedback)

### Key Discovery
Retros (3984) are **intentionally excluded** from graph API to prevent O(n²) explosion:
- 459 nodes → ~210k link comparisons (manageable)
- 4443 nodes → ~20M link comparisons (performance death)

---

## AI Diary

Quick polish session. User knew exactly what needed fixing. The memory leak fix was straightforward - just needed to dispose geometries and materials properly.

The "no retro" mystery was interesting - seemed like a bug but was actually intentional performance optimization. Always check the server code before assuming frontend issues.

User's UX feedback was spot-on: "just link, no button" - cleaner, more native feel. The filename-as-link pattern is much better than a separate "View Content" button.

---

## Commits This Session

### oracle-v2
- `e386fd4` feat(graph3d): Type filter, memory leak fix, file viewer

### Nat-s-Agents
- (this retrospective)

---

## What's Next

- Consider adding retro sampling to graph (e.g., top 50 by recency)
- Performance optimization with instanced meshes
- Search highlighting in 3D view

---

*Session ended at 79% context*
