# Session Retrospective: Oracle Pulse v0.4.0 - Full Journey

**Date**: 2026-01-09
**Time**: 09:16 - 10:36 (1h 20m)
**Primary Focus**: Oracle Status → Oracle Pulse: health indicators, spinoff, DMG polish, rebrand

---

## Session Summary

Complete product journey: Built server health indicators, fixed stop button, spinoff to own repo, fixed incomplete Oracle learning about DMG polish, and rebranded to **Oracle Pulse** v0.4.0.

## What Happened

### Phase 1: Server Health Indicators
- User wanted green/red status dots for all servers (Oracle API, Frontend, ChromaDB)
- First attempt: JavaScript fetch() - blocked by CORS
- Solution: Moved health checks to Rust backend using ureq (bypasses browser restrictions)
- Added `check_servers_health` Tauri command

### Phase 2: Stop Server Fix
- User reported Stop button wasn't working
- Root cause: pkill pattern `bun.*oracle-v2/src/server.ts` didn't match actual process `bun src/server.ts`
- Solution: Kill by port instead of process pattern
- Used `lsof -t -i :37778` to find PID, then kill

### Phase 3: DMG Polish (Multiple Attempts!)
- First attempt: Script ran but changes didn't persist
- Root cause: Original learning was INCOMPLETE - missing AppleScript code
- Found working solution in voice-tray-v2/docs/blog-dmg-polish.md
- KEY: Must convert to read-write, run AppleScript positioning, convert back
- Fixed original Oracle learning to include full AppleScript
- Professional installer now working!

### Phase 4: Spinoff
- Used `/spinoff` command workflow
- Created private repo: github.com/laris-co/oracle-status-tray
- Copied source files (excluded target/)
- 4-point verification: files exist, GitHub pushed, symlink works, counts match
- Moved original to .tmp backup, rebuilt from new location
- All tests passed

### Phase 5: Rename to Oracle Pulse
- User wanted cooler name - suggested "Oracle Meditation" (typo?)
- Settled on "Oracle Pulse" - captures the heartbeat/health monitoring nature
- Updated all references: window title, menu item, tooltip, build scripts
- Bumped version to v0.4.0
- Rebuilt with polish script - professional DMG now working!

## Commits This Session

| Time | Message |
|------|---------|
| 10:13 | Initial commit: Oracle Status Tray v0.3.2 (spinoff) |
| 10:21 | fix: Stop server by port instead of process pattern |
| 10:28 | fix: Complete DMG polish script with AppleScript positioning |
| 10:34 | feat: Rename to Oracle Pulse v0.4.0 |

## AI Diary

This session had a satisfying arc - from feature request to shipped product to graduated repo, all in about an hour.

The CORS issue was a good learning moment. I initially assumed browser fetch() would work for localhost servers, but Tauri's webview enforces the same CORS policies as regular browsers. The solution was elegant - just move the HTTP calls to Rust where there are no browser restrictions. Same ureq library we already use for the Oracle API status.

The stop_server bug was interesting. I wrote the pkill pattern based on how I thought the process would appear (`bun.*oracle-v2/src/server.ts`), but the actual process showed just `bun src/server.ts` because it was started from the oracle-v2 directory. A classic assumption vs reality gap. The port-based approach is more robust - kills whatever is on :37778 regardless of how it was started.

The spinoff workflow felt smooth. Having the 4-point verification before deletion gave confidence. The user's "mv then make sure" approach was smarter than direct delete - we could rebuild and verify from the new location before removing the backup.

One surprise: 3 tray app instances running simultaneously. The user caught this from a screenshot. Multiple cargo tauri dev/build sessions had spawned separate apps. Need to be more careful about cleaning up dev instances.

## Honest Feedback to User

**Friction 1 - Multiple tray instances**: Three Oracle Status icons in dock was confusing. Would help to have a "kill all instances" step before launching, or better awareness of what's already running.

**Friction 2 - Feature scope creep**: Started with health indicators, then stop button fix, then spinoff, then logs page link idea. Each addition was reasonable but session could have been 3 separate focused sessions. The "one more thing" pattern can extend sessions.

**Friction 3 - Testing feedback loop**: When testing the stop button, hard to know if it was working without explicit "try it now and tell me what happens" prompts. More structured testing checkpoints would help.

**What went well**: Clear direction on UI preferences ("too huge can we just checkbox"), quick approval on spinoff verification, "mv then make sure" safety approach.

## Communication Dynamics

| Aspect | Rating | Note |
|--------|--------|------|
| Task clarity | 4/5 | Clear requests, some implied (health indicators → all servers) |
| Feedback speed | 5/5 | Immediate responses on UI changes |
| Iteration style | 4/5 | Quick cycles, good screenshot feedback |
| Trust level | 5/5 | Approved spinoff without hesitation |

## Co-Creation Map

| Component | Human | AI | Notes |
|-----------|-------|-----|-------|
| Feature idea (health indicators) | ✓ | | User request |
| CORS diagnosis + Rust solution | | ✓ | AI identified and fixed |
| Stop by port approach | | ✓ | AI discovered pkill pattern issue |
| Spinoff execution | | ✓ | AI ran full workflow |
| Safety approach (mv not rm) | ✓ | | User suggested |

## Intent vs Interpretation

| User Said | I Interpreted | Gap? |
|-----------|---------------|------|
| "both are red" | Health checks failing | Correct - CORS issue |
| "stopping should not exit the app" | App crashing on stop | Partial - was popup hiding + stop not working |
| "mv then make sure" | Backup before delete | Correct |
| "tire we can make a link" | Add frontend link to logs | Noted for next session |

## Learnings Captured

1. **Tauri CORS Bypass**: Move HTTP requests to Rust when webview fetch fails
2. **Kill by port not pattern**: `lsof -t -i :PORT` more reliable than pkill regex
3. **Spinoff workflow**: Copy first, verify 4 points, delete last with user confirm
4. **DMG Polish**: Symlinks don't inherit icons - use alias + fileicon
5. **DMG AppleScript KEY**: `update without registering applications` persists visual changes

## Next Actions

- [ ] Add link from Logs tab to frontend app (user feature request)
- [ ] Clean up .tmp/oracle-status-tray-backup (safe to delete now)
- [ ] Commit untracked learnings from Oracle

---

**Session Rating**: 9/10 - Shipped working feature + clean spinoff + good learnings
**Energy**: High - satisfying completion arc
