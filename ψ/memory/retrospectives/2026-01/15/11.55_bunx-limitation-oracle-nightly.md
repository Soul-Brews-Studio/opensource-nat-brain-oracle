# Retrospective: bunx Limitation Discovery + Oracle Nightly Release

**Session Date**: 2026-01-15
**Start Time**: ~11:31 GMT+7
**End Time**: 11:55 GMT+7
**Duration**: ~24 minutes
**Context**: 60%
**Primary Focus**: Debug bunx remote install, learn from claude-mem, rebrand Oracle

## Timeline

| Time | Event |
|------|-------|
| 11:31 | Session start - Continue from previous compacted session |
| 11:33 | User asks about MCP debug logs on remote |
| 11:41 | SSH to 192.168.1.184 - Test oracle-v2 MCP |
| 11:42 | Discovered bunx GitHub doesn't install node_modules! |
| 11:43 | Fixed mise node@22.22.0 warning |
| 11:44 | Upgraded bun 1.1.20 → 1.3.6 on remote |
| 11:45 | Confirmed: bunx caches repo but NO node_modules |
| 11:46 | Workaround: Clone to ~/.local/share/, bun install |
| 11:47 | Updated remote Claude config to use local path |
| 11:48 | Created learning: bunx-github-no-node-modules |
| 11:49 | Learned from claude-mem ProcessManager pattern |
| 11:50 | Created install.sh script for oracle-v2 |
| 11:51 | Added acknowledgments section to README |
| 11:53 | Tested install script on remote - works! |
| 11:54 | Rebranded: "Oracle v2" → "Oracle Nightly" |
| 11:55 | Version bump: 0.0.0-nightly → 0.2.1-nightly |

## What We Did

### Critical Discovery: bunx GitHub Limitation

Discovered that `bunx github:owner/repo`:
- Downloads repo to `~/.bun/install/cache/@GH@...`
- **Does NOT run `bun install`**
- Result: Silent failure (exit 1, no output)

This explains why bunx worked locally (after manual install) but failed on fresh machines.

### Workaround Implemented

```bash
# Instead of bunx github:...
git clone ... ~/.local/share/oracle-v2
cd ~/.local/share/oracle-v2 && bun install
# Then use local path in Claude config
```

### Claude-mem Learning

Studied claude-mem v9.0.0 ProcessManager:
- PID file pattern (`~/.app/worker.pid`)
- Daemon spawning (`spawn` with `detached: true`)
- Graceful shutdown (signal handlers)
- Orphan cleanup on startup

### Oracle-v2 Updates

1. **Install script** - `scripts/install.sh` for one-liner setup
2. **README** - Added bunx warning + claude-mem acknowledgments
3. **Rebrand** - "Oracle v2" → "Oracle Nightly"
4. **Version** - 0.2.1-nightly

## AI Diary

This session was a masterclass in the gap between "it works on my machine" and "it works everywhere." I started feeling confident after the earlier CI victories, but the remote testing on 192.168.1.184 humbled me quickly.

The bunx discovery was frustrating at first - why would a tool called "bunx" that's supposed to run packages NOT install dependencies? But as I traced through the issue, I realized it's actually consistent behavior: bunx for npm packages works because npm packages come pre-bundled. GitHub repos are just... repos. The tool does exactly what it says, just not what I assumed.

What made this session feel meaningful was the learning from claude-mem. Reading their ProcessManager.ts felt like studying from a senior developer's playbook. The patterns are clean: PID files for coordination, detached spawning for daemons, signal handlers for graceful shutdown. I feel less like I'm inventing and more like I'm applying proven patterns.

The vulnerability: I almost gave up on bunx and was about to tell the user "just use npm publish." But pushing through the debugging revealed something genuinely useful for the community. Not every problem needs to be worked around - sometimes understanding the limitation IS the value.

## Honest Feedback

### What Went Well
- Systematic debugging revealed root cause (not just symptoms)
- Claude-mem study provided production-ready patterns
- Remote testing caught real-world issues early
- Install script makes oracle-v2 genuinely usable

### Friction Points

1. **bunx documentation gap** - Spent 20+ minutes debugging what should be in bunx docs: "GitHub packages require manual dependency installation." This is a common enough use case that it deserves explicit documentation.

2. **SSH session noise** - The `mise WARN` and `nvm.sh` warnings on every SSH command made output hard to parse. Had to use `grep -E` filters constantly. Should have cleaned up remote shell config first.

3. **Version hardcoding** - Found version `0.2.0` hardcoded in two places in index.ts. This pattern (hardcoded versions in source) is fragile. Should read from package.json or use build-time injection.

### What Could Be Better
- Add version reading from package.json at build time
- Create a "remote testing checklist" for MCP servers
- Document bunx limitation in a more prominent place

## Lessons Learned

1. **bunx github:X ≠ npm install** - It's a cache + run, not a package manager
2. **Study existing solutions** - claude-mem patterns saved hours of design
3. **Test on fresh machines** - CI passing ≠ works everywhere
4. **Acknowledge inspirations** - Credit where credit is due (claude-mem)

## Next Steps

- [ ] Add ProcessManager CLI to oracle-v2 (start/stop/restart/status)
- [ ] Consider npm publish for easier bunx experience
- [ ] Clean up remote machine shell config (remove warnings)
- [ ] Add version injection at build time

## Technical Artifacts

### Commits (oracle-v2)
```
fc9cd47 fix: Update hardcoded version to 0.2.1
2c95f77 chore: Bump to v0.2.1-nightly + rebrand to Oracle Nightly
c4378cb feat: Add install script + acknowledge claude-mem inspiration
```

### Commits (Nat-s-Agents)
```
2072a860 learn: bunx GitHub limitation + claude-mem daemon pattern
1be0297a docs: Add Timeline section to oracle-v2 retrospective
```

### Key Files Created
- `ψ/memory/learnings/2026-01-15_bunx-github-no-node-modules.md`
- `ψ/memory/learnings/2026-01-15_claude-mem-daemon-process-pattern.md`
- `oracle-v2/scripts/install.sh`
