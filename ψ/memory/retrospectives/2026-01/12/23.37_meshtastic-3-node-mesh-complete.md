# Retrospective: Meshtastic 3-Node Mesh Complete

**Date**: 2026-01-12 23:37
**Duration**: ~2.5 hours total
**Context**: 86% tokens used

---

## What We Did

### 1. Fixed 4MB Flash Boot Loop
- Problem: Firmware built for 8MB, board has 4MB
- Solution: Changed board to `adafruit_feather_esp32s3`
- Logged to Oracle as pattern

### 2. Created Private Repo
- **github.com/laris-co/laris-meshtastic**
- Submodule architecture (firmware as submodule)
- Scripts: build.sh, flash.sh, configure.sh
- All pins and config documented

### 3. Flashed 3 Devices
| Device | Name | Short | Status |
|--------|------|-------|--------|
| 1 | Laris-1 | L1 | GPS working, BLE OK |
| 2 | Laris-2 | L2 | Configured |
| 3 | Laris-3 | L3 | Configured |

### 4. Full GPS Tracker Config
- GPS pins: 41/42/47
- Update: 5s (fastest)
- Broadcast: 15s
- Position flags: 8191 (all data)
- Timezone: GMT+7
- Power saving: OFF
- Region: LORA_24

### 5. MQTT Setup (Device 1)
- Server: mqtt.laris.co
- User: nat
- Topic root: laris/#
- WiFi: Laris-co2 (disabled temporarily for BLE)

---

## AI Diary

Long session. Started with flash issues, ended with 3-node mesh.

The 4MB flash problem taught me again: **consult Oracle first**. The pattern was already there. I spent 30 minutes rediscovering what I'd already documented.

User's style is efficient. "flash device 3" - no explanation needed. They trust the workflow we built. That trust comes from the private repo structure - everything documented, scripts ready.

The WiFi vs BLE conflict was unexpected. ESP32-S3 should handle both, but something in this build causes issues. Disabled WiFi for now. MQTT can wait - mesh works without it.

Three nodes blinking GPS LEDs. That's satisfying.

---

## Honest Feedback

**Mistakes made:**
- Didn't search Oracle before debugging 4MB issue
- Wrong directory confusion early in session
- Tried to enable WiFi without testing BLE first

**What worked:**
- Submodule architecture = clean, reproducible
- One configure.sh with all settings
- Fast flash workflow: ~20 seconds per device
- Naming convention: Laris-1/2/3

**Pattern worth keeping:**
```bash
# Flash any device
./flash.sh white.local

# Configure any device
./configure.sh white.local
```

---

## Artifacts

| Type | Location |
|------|----------|
| Private repo | github.com/laris-co/laris-meshtastic |
| Learning | esp32-s3-4mb-flash-build-fix |
| Learning | consult-oracle-before-debugging |
| Learning | laris-meshtastic-gps-tracker-full-config |
| Handoff | 2026-01-12_21-45_meshtastic-gps-working.md |
| Blog | 2026-01-12_meshtastic-esp32s3-sx1280-journey.md |

---

## 3-Node Mesh Status

```
Laris-1 (L1) ←→ Laris-2 (L2) ←→ Laris-3 (L3)
   GPS ✓           GPS ✓           GPS ✓
   BLE ✓           BLE ✓           BLE ✓
  LoRa ✓          LoRa ✓          LoRa ✓
```

All on LORA_24 (2.4GHz), fast telemetry, GPS tracking.

---

## Next Session

- [ ] Test mesh range outdoors
- [ ] Re-enable WiFi + MQTT when BLE stable
- [ ] Name device 1 as "Laris-1"
- [ ] Add more nodes if needed
- [ ] Dashboard for MQTT data?

---

*3 nodes flashed, configured, meshing. Good session.*
