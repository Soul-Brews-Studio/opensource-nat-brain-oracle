# rrr: Voice Tray v2 Logo + Duplicate Icon Fix

üìÖ 2026-01-02 22:48

## Session Summary

‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á v4 logo ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Voice Tray v2 ‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ bug duplicate tray icon

## What We Did

### 1. Logo Installation
- Converted v4 symbiotic human+AI logo to RGBA icons
- Generated all sizes: 16, 32, 64, 128, 256, 512, 1024
- Created `.icns` for macOS bundle
- Rebuilt Voice Tray v2 with new branding

### 2. Bug Fix: Duplicate Tray Icons

**Problem**: Two tray icons appeared in menu bar

**Root Cause**: Dual tray initialization (Tauri 2.0 issue #8982)
- `tauri.conf.json` had `trayIcon` config
- `lib.rs` had `TrayIconBuilder::new()`
- Both create separate tray instances

**Fix**: Removed `trayIcon` section from config, kept only code-based initialization

```diff
// tauri.conf.json
  "app": {
    "withGlobalTauri": true,
-   "trayIcon": {
-     "iconPath": "icons/32x32.png",
-     "iconAsTemplate": false
-   },
    "windows": [
```

**Reference**: Same fix as Issue #74 (oracle-status-tray)

## Technical Learnings

| Pattern | Detail |
|---------|--------|
| **Tauri tray: config OR code** | Never both - creates duplicate icons |
| **ImageMagick for RGBA** | `magick source.png -resize NxN -background none -alpha set output.png` |
| **iconutil for icns** | Create `.iconset` folder with all sizes, then `iconutil -c icns` |
| **/trace works** | Found past bug fix in seconds via Oracle + context-finder |

## Files Changed

```
œà/incubate/voice-tray-v2/src-tauri/
‚îú‚îÄ‚îÄ tauri.conf.json          # Removed trayIcon section
‚îî‚îÄ‚îÄ icons/
    ‚îú‚îÄ‚îÄ 32x32.png            # v4 logo (RGBA)
    ‚îú‚îÄ‚îÄ 128x128.png          # v4 logo (RGBA)
    ‚îú‚îÄ‚îÄ 128x128@2x.png       # v4 logo (RGBA)
    ‚îî‚îÄ‚îÄ icon.icns            # v4 logo (macOS bundle)
```

## Deliverables

- ‚úÖ Voice Tray v2 @ `/Applications/voice-tray-v2.app`
- ‚úÖ v4 symbiotic human+AI logo installed
- ‚úÖ Single tray icon (no duplicates)
- ‚úÖ MQTT + HTTP backends working

## AI Diary

Short focused session - user wanted v4 logo installed. Hit the duplicate icon bug I accidentally introduced earlier by adding `trayIcon` config. Used `/trace` to find our past fix from Issue #74 (oracle-status-tray) - same root cause, same solution.

Pattern recognition is powerful. Oracle remembers what we've solved before. The trace took 20 seconds and saved 20 minutes of debugging.

## Honest Feedback

**What worked:**
- `/trace` ‚Üí Oracle search ‚Üí found exact fix instantly
- Retrospective from Dec 30 had full context
- Pattern: "config OR code, never both" is now well documented

**What could improve:**
- I caused the bug by adding `trayIcon` config thinking it would help
- Should have remembered the Issue #74 fix before touching config
- Need to internalize: "Tauri tray = code only" as a rule

## Next

- Voice Tray v2 complete with new logo
- Ready for daily use

